{"version":3,"sources":["components/canvas/canvasViewer.component.ts"],"names":[],"mappings":"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","file":"canvasViewer.component.js","sourcesContent":["import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\nimport { Component, ViewChild, Input } from \"@angular/core\";\r\nimport { IResponse, IImageOptions } from \"../../models/viewModels\";\r\n//import 'js/tiff.js';\r\n\r\n@Component({\r\n    selector: \"canvas-viewer\",\r\n    templateUrl: \"/view/components/canvas/canvasViewer.component.html\"\r\n})\r\n\r\nexport class CanvasViewerComponent {\r\n    @ViewChild(\"imageViewer\") imageViewer;\n    context: CanvasRenderingContext2D;\n    reader: any;\r\n    @Input() public imagePath;\r\n    @Input() public options: IImageOptions;\r\n    @Input() public overlays;\r\n    // @Input() title = \"\";\r\n\r\n    curPos = { x: 0, y: 0 };\r\n    picPos = { x: 0, y: 0 };\r\n    mousePos = { x: 0, y: 0 };\n    onchange = () => {\n        var imageReader = new ImageReader();\r\n        this.options.zoom.value = 1.0;\r\n        this.options.rotate.value = 0;\r\n        this.curPos = { x: 0, y: 0 };\r\n        this.picPos = { x: 0, y: 0 };\n        let canvas = this.imageViewer.nativeElement;\n        this.context = canvas.getContext(\"2d\");\n        this.options.ctx = this.context;\n        var canvasSize = canvas.parentNode;\r\n        this.context.canvas.width = canvasSize.clientWidth;\r\n        this.context.canvas.height = canvasSize.clientHeight;\r\n        var resize = { height: canvasSize.clientHeight, width: canvasSize.clientWidth };\n        if (typeof (this.imagePath) === 'object') {\r\n            // Object type file\r\n            if (imageReader.IsSupported(this.imagePath.type)) {\r\n                // get object\r\n                this.reader = imageReader.CreateReader(this.imagePath.type, this.imagePath).create(this.imagePath, this.options, this.onloadeddata);\r\n                // Create image\r\n                //this.reader = decoder.create(this.imagePath, this.options, onload);\r\n            } else {\r\n                console.log(this.imagePath.type, ' not supported !');\r\n            }\r\n        } else if (typeof (this.imagePath) === 'string') {\n            //this.reader = imageReader.CreateReader(\"\", this.imagePath).create(this.imagePath, this.options, this.onloadeddata);//, $q, $timeout);\r\n            this.reader = imageReader.CreateReader(\"image/jpeg\").create(this.imagePath, this.options, this.onloadeddata);//, $q, $timeout);\r\n\r\n        }\n        this.applyTransform();\r\n    }\n    ngAfterViewInit() {\n        this.onchange();\r\n    }\r\n    constructor() {\r\n\r\n    }\r\n    ngOnChanges() {\r\n        this.onchange();\r\n    }\r\n    onloadeddata = () => {\r\n        if (this.reader == null) {\r\n            return;\r\n        }\r\n\r\n        if (this.reader.rendered) {\r\n            this.applyTransform();\r\n        } else {\r\n\r\n            this.resizeTo(this.options.controls.fit);\r\n        }\r\n    }\r\n\r\n    zoom = (direction) => {\r\n        var oldWidth, newWidth = 0;\r\n        var oldHeight, newHeight = 0;\r\n        // Does reader support zoom ?\r\n        // Compute correct width\r\n        if (!this.reader.isZoom) {\r\n            oldWidth = this.reader.oldwidth;\r\n            oldHeight = this.reader.height;\r\n        } else {\r\n            oldWidth = this.reader.width * this.options.zoom.value;\r\n            oldHeight = this.reader.height * this.options.zoom.value;\r\n        }\r\n\r\n        // Compute new zoom\r\n        this.options.zoom.value += this.options.zoom.step * direction;\r\n        // Round\r\n        this.options.zoom.value = Math.round(this.options.zoom.value * 100) / 100;\r\n        if (this.options.zoom.value >= this.options.zoom.max) {\r\n            this.options.zoom.value = this.options.zoom.max;\r\n        }\r\n        if (this.options.zoom.value <= this.options.zoom.min) {\r\n            this.options.zoom.value = this.options.zoom.min;\r\n        }\r\n        //alert(this.options.zoom.value);\r\n        // Refresh picture\r\n        if (this.reader.refresh != null) {\r\n            this.reader.refresh();\r\n        }\r\n\r\n        // Compute new image size\r\n        if (!this.reader.isZoom) {\r\n            newWidth = this.reader.width;\r\n            newHeight = this.reader.height;\r\n        } else {\r\n            newWidth = this.reader.width * this.options.zoom.value;\r\n            newHeight = this.reader.height * this.options.zoom.value;\r\n        }\r\n        // new image position after zoom\r\n        this.picPos.x = this.picPos.x - (newWidth - oldWidth) / 2;\r\n        this.picPos.y = this.picPos.y - (newHeight - oldHeight) / 2;\r\n        this.applyTransform();\r\n\r\n    }\r\n\r\n    rotate = (direction) => {\r\n       // alert(this.options.zoom.value);\r\n\r\n        this.options.rotate.value += this.options.rotate.step * direction;\r\n        if ((this.options.rotate.value <= -360) || (this.options.rotate.value >= 360)) {\r\n            this.options.rotate.value = 0;\r\n        }\r\n        this.applyTransform();\r\n        //this.resizeTo('page');\r\n    }\r\n    resizeTo = (value) => {\r\n        if ((this.context.canvas == null) || (this.reader == null)) {\r\n            return;\r\n        }\r\n        // Compute page ratio\r\n        var options = this.options;\r\n        var ratioH = this.context.canvas.height / this.reader.height;\r\n        var ratioW = this.context.canvas.width / this.reader.width;\r\n        // If reader render zoom itself\r\n        // Precompute from its ratio\r\n        if (!this.reader.isZoom) {\r\n            ratioH *= this.options.zoom.value;\r\n            ratioW *= this.options.zoom.value;\r\n        }\r\n        // Adjust value\r\n        switch (value) {\r\n            case 'width': this.options.zoom.value = ratioW; break;\r\n            case 'height': this.options.zoom.value = ratioH; break;\r\n            case 'page':\r\n            default: this.options.zoom.value = Math.min(ratioH, ratioW);\r\n        }\r\n        this.options.zoom.value = Math.round(this.options.zoom.value * 100) / 100;\r\n        // Update options state\r\n        this.options.controls.fit = value;\r\n        if (!this.reader.isZoom) {\r\n            if (this.reader.refresh != null) {\r\n                this.reader.refresh();\r\n            }\r\n\r\n            // Re center image\r\n            this.centerPics();\r\n        } else {\r\n            // Re center image\r\n            this.centerPics();\r\n            this.applyTransform();\r\n        }\r\n    }\r\n\r\n    centerPics = () => {\r\n        // Position to canvas center\r\n        var centerX = this.context.canvas.width / 2;\r\n        var picPosX = 0;\r\n        picPosX = centerX - (this.reader.width * this.options.zoom.value) / 2;\r\n        this.curPos = { x: picPosX, y: 0 };\r\n        this.picPos = { x: picPosX, y: 0 };\r\n    }\r\n\r\n\r\n    applyTransform = () => {\r\n        if (this.reader == null) {\r\n            return;\r\n        }\r\n        if (!this.reader.rendered) {\r\n            return;\r\n        }\r\n        var options = this.options;\r\n        var canvas = this.context.canvas;\r\n        var centerX = this.reader.width * this.options.zoom.value / 2;\r\n        var centerY = this.reader.height * this.options.zoom.value / 2;\r\n        // Clean before draw\r\n        this.context.clearRect(0, 0, canvas.width, canvas.height);\r\n        // Save context\r\n        this.context.save();\r\n        // move to mouse position\r\n        this.context.translate((this.picPos.x + centerX), (this.picPos.y + centerY));\r\n        // Rotate canvas\r\n        this.context.rotate(options.rotate.value * Math.PI / 180);\r\n        // Go back\r\n        this.context.translate(- centerX, - centerY);\r\n        // Change scale\r\n        if (this.reader.isZoom)\r\n            this.context.scale(this.options.zoom.value, this.options.zoom.value);\r\n        if ((!this.options.controls.filmStrip) || (this.options.controls.totalPage == 1)) {\r\n            if (this.reader.img != null) {\r\n                this.context.drawImage(this.reader.img, 0, 0, this.reader.width, this.reader.height);\r\n                this.context.beginPath();\r\n                this.context.rect(0, 0, this.reader.width, this.reader.height);\r\n                this.context.lineWidth = 0.2;\r\n                this.context.strokeStyle = \"#000000\";\r\n                this.context.stroke();\r\n            }\r\n            // Draw image at correct position with correct scale\r\n            if (this.reader.data != null) {\r\n                this.context.putImageData(this.reader.data, this.picPos.x, this.picPos.y);\r\n                this.context.beginPath();\r\n                this.context.rect(0, 0, this.reader.width, this.reader.height);\r\n                this.context.lineWidth = 0.2;\r\n                this.context.strokeStyle = \"#000000\";\r\n                this.context.stroke();\r\n            }\r\n        } else {\r\n            if (this.reader.images != null) {\r\n                for (var i = 0; i < this.reader.images.length; i++) {\r\n                    var image = this.reader.images[i];\r\n                    // angular.forEach(this.reader.images, function (image) {\r\n                    this.context.drawImage(image, 0, 0, image.width, image.height);\r\n                    this.context.beginPath();\r\n                    this.context.rect(0, 0, image.width, image.height);\r\n                    this.context.lineWidth = 0.2;\r\n                    this.context.strokeStyle = \"#000000\";\r\n                    this.context.stroke();\r\n                    this.context.translate(0, image.height + 15);\r\n                }//);\r\n            }\r\n            // Draw image at correct position with correct scale\r\n            if (this.reader.data != null) {\r\n                var offsetY = 0;\r\n                for (var i = 0; i < this.reader.data.length; i++) {\r\n                    var data = this.reader.data[i];\r\n                    // angular.forEach(this.reader.data, function (data) {\r\n                    this.context.putImageData(data, this.picPos.x, this.picPos.y + offsetY);\r\n                    this.context.beginPath();\r\n                    this.context.rect(0, 0, this.reader.width, this.reader.height);\r\n                    this.context.lineWidth = 0.2;\r\n                    this.context.strokeStyle = \"#000000\";\r\n                    this.context.stroke();\r\n                    offsetY += this.reader.height + 15;\r\n                    this.context.translate(0, offsetY);\r\n                }//);\r\n            }\r\n        }\r\n        // Restore\r\n        this.context.restore();\r\n\r\n        // Draw overlays\r\n        if (this.overlays.length > 0) {\r\n            for (var i = 0; i < this.overlays.length; i++) {\r\n                var item = this.overlays[i];\r\n                //angular.forEach(this.overlays, function (item) {\r\n                this.context.save();\r\n                // move to mouse position\r\n                this.context.translate((this.picPos.x + centerX), (this.picPos.y + centerY));\r\n                // Rotate canvas\r\n                this.context.rotate(this.options.rotate.value * Math.PI / 180);\r\n                // Go back\r\n                this.context.translate(- centerX, - centerY);\r\n                // Change scale\r\n                this.context.scale(this.options.zoom.value, this.options.zoom.value);\r\n                // Start rect draw\r\n                this.context.beginPath();\r\n                this.context.rect((item.x), (item.y), item.w, item.h);\r\n                this.context.fillStyle = item.color;\r\n                this.context.globalAlpha = 0.4;\r\n                this.context.fill();\r\n                this.context.lineWidth = 1;\r\n                this.context.strokeStyle = item.color;\r\n                this.context.stroke();\r\n                this.context.restore();\r\n            }\r\n        }\r\n    }\r\n\r\n}"]}